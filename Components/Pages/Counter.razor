@page "/counter"
@using BlazorPopUpOnLoadPoC.Components.Common
@using System.Timers
@rendermode InteractiveServer

<PageTitle>Counter</PageTitle>

<h1>Counter</h1>

<p role="status">Current count: @currentCount</p>

<button class="btn btn-primary" @onclick="Success">Success me</button>
<button class="btn btn-primary" @onclick="Error">Error me</button>
<button class="btn btn-primary" @onclick="Info">Info me</button>
<p> sticky:</p>
<Popup @ref="popupRef" />

<button class="btn btn-primary" @onclick="SuccessSticky">Success me</button>
<button class="btn btn-primary" @onclick="ErrorSticky">Error me</button>
<button class="btn btn-primary" @onclick="InfoSticky">Info me</button>

@code {
    private int currentCount = 0;
    private Popup popupRef = new Popup();

    protected override void OnAfterRender(bool firstRender)
    {
        if (firstRender)
        {
            if (!popupRef.IsVisible)
            {
                popupRef.Show("message here", "title here");

                StateHasChanged();
            }

        }
    }


    private void Success()
    {
        currentCount++;
        popupRef.Show("message here", "title here");
    }

    private void Error()
    {
        currentCount++;
        popupRef.Show("message here", "title here", ToastType.Error);
    }

    private void Info()
    {
        currentCount++;
        popupRef.Show("message here", "title here", ToastType.Info);
    }

    private void SuccessSticky()
    {
        currentCount++;
        popupRef.Show("message here", "title here", ToastType.Success, true);
    }

    private void ErrorSticky()
    {
        currentCount++;
        popupRef.Show("message here", "title here", ToastType.Error, true);
    }

    private void InfoSticky()
    {
        currentCount++;
        popupRef.Show("message here", "title here", ToastType.Info, true);
    }
}
